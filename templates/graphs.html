<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>{{ year }} Incident RCA Graphs</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}" />
</head>
<body>
    <div class="page">
        <div class="page-header">
            <h1>{{ year }} Incident RCA Graphs</h1>
            <div class="header-links">
                <a class="admin-link" href="{{ url_for('stats_view') }}">Stats</a>
                <a class="admin-link" href="{{ url_for('index') }}">Back to Dashboard</a>
            </div>
        </div>

        <form class="control-form" method="GET" action="{{ url_for('graphs_view') }}">
            <div class="control-row">
                <label>
                    Year
                    <input type="number" name="year" value="{{ year }}" min="2000" max="2100" />
                </label>
                <button type="submit" class="primary-button">Update</button>
            </div>
        </form>

        <div class="graph-card">
            <div class="graph-card-header">
                <div>
                    <h2 class="graph-title">RCA by Day of Month</h2>
                    <p class="helper-text">Each row shows a month; each column is a day (1-31). Colors reflect RCA classification.</p>
                </div>
                <div class="legend-row graph-legend">
                    {% for item in legend %}
                    <span class="legend-item">
                        <span class="legend-color status-{{ item.status }}"></span>
                        {{ item.label }}
                    </span>
                    {% endfor %}
                </div>
            </div>

            <div class="graph-grid">
                <div class="graph-rows">
                    {% for row in month_rows %}
                    <div class="graph-row">
                        <div class="month-label">{{ row.label }}</div>
                        <div class="graph-bar" role="presentation">
                            {% for cell in row.cells %}
                            <div
                                class="day-cell status-{{ cell.status }}"
                                title="{{ cell.label }}"
                                aria-label="{{ cell.label if cell.label else row.label ~ ' day ' ~ cell.day }}"
                            ></div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="graph-axis">
                    <div class="month-label axis-label">Day</div>
                    <div class="graph-bar axis-days">
                        {% for day in range(1, 32) %}
                        <div class="axis-day">{{ day }}</div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
